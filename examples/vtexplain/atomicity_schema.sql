WITH RECURSIVE UserHierarchy AS ( SELECT id, name, manager_id, 1 AS level FROM user WHERE manager_id IS NULL UNION ALL SELECT e.id, e.name, e.manager_id, eh.level + 1 AS level FROM user e INNER JOIN UserHierarchy eh ON e.manager_id = eh.id ) SELECT * FROM UserHierarchy